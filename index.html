<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>斗六高中學生會 | 官方網站</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">斗中學生會</a>
            <ul class="nav-links">
                <li><a href="#announcement-grid">最新動態</a></li>
                <li><a href="activities.html">行政部門</a></li>
                <li><a href="#">特約商家</a></li>
                <li><a href="#">意見箱</a></li>
            </ul>
        </div>
    </nav>

    <header>
        <h1>斗六高中學生會</h1>
        <div class="subtitle">簡約專業 · 凝聚向心力</div>
    </header>

    <div class="container">
        <h2>行政部門中心</h2>
        <div class="grid">
            <a href="president.html" class="card"><div class="card-body"><h3>正副會長室</h3><p>核心決策與校務溝通窗口。</p></div></a>
            <a href="activities.html" class="card"><div class="card-body"><h3>活動部</h3><p>策劃校園生活，創造共同回憶。</p></div></a>
            <a href="public-relations.html" class="card"><div class="card-body"><h3>公關部</h3><p>對外連結，爭取權益與合作。</p></div></a>
            <a href="design.html" class="card"><div class="card-body"><h3>美宣部</h3><p>視覺設計，打造斗中品牌美學。</p></a>
            <a href="documents.html" class="card"><div class="card-body"><h3>文書部</h3><p>會議紀錄與檔案管理，行政透明化。</p></div></a>
            <a href="documents.html" class="card"><div class="card-body"><h3>總務部</h3><p>財務透明，每一分經費精準運用。</p></a>
        </div>

        <h2 id="announcement-grid">最新動態</h2>
        <div id="announcement-grid-content" class="grid">
            <p>正在連線至後台，請稍候...</p>
        </div>
    </div>

    <footer>
        &copy; 2026 國立斗六高級中學學生會. All Rights Reserved.
    </footer>

<script>
    const spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQQ7BWI3HaxcFZFKNmSBirSF1d3fQ1VDFhat9xn6HgteL6eSHSAVqggtq4CMPB5YF5_0sVRl-Ij4eZm/pub?output=csv';

    async function loadAnnouncements() {
        try {
            const response = await fetch(spreadsheetUrl);
            const data = await response.text();
            const rows = data.split('\n').filter(row => row.trim() !== '').slice(1);
            const container = document.getElementById('announcement-grid-content');
            
            if (rows.length === 0) {
                container.innerHTML = '<p>目前尚無最新消息。</p>';
                return;
            }

            container.innerHTML = ''; 

            rows.forEach(row => {
                const cols = row.split(',');
                if (cols.length >= 2) {
                    const category = cols[0] || '一般';
                    const title = cols[1] || '無標題';
                    const content = cols[2] || '';
                    const date = cols[3] || '';
                    const link = cols[4] ? cols[4].trim() : '#';
                    const type = cols[5] ? cols[5].trim().toLowerCase() : 'info';
                    const imageUrl = cols[6] ? cols[6].trim() : ''; 
                    const tagClass = `tag-${type}`;

                    const imageHtml = imageUrl 
                        ? `<div class="card-image"><img src="${imageUrl}" alt="${title}"></div>` 
                        : `<div class="card-image placeholder"></div>`;

                    const card = `
                        <a href="${link}" class="card">
                            ${imageHtml}
                            <div class="card-body">
                                <span class="category-tag ${tagClass}">[${category}] ${date}</span>
                                <h3>${title}</h3>
                                <p>${content}</p>
                            </div>
                        </a>
                    `;
                    container.innerHTML += card;
                }
            });
        } catch (error) {
            console.error('讀取失敗:', error);
            document.getElementById('announcement-grid-content').innerHTML = '<p>暫時無法載入公告。</p>';
        }
    }
    loadAnnouncements();
</script>
</body>
</html>
